<!DOCTYPE html>
<html lang="zxx">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Health Plus Responsive web template" />
<link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
<link href="css/font-awesome.css" rel="stylesheet"> 
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>
<title>Manage Schedule</title>
</head>
<body>
<div class="main" id="home">
    <div class="header_agileinfo">
        <div class="w3_agileits_header_text">
            <ul class="top_agile_w3l_info_icons">
                <li><i class="fa fa-home" aria-hidden="true"></i>WTC Ciudad de MÃ©xico</li>
                <li class="second"><i class="fa fa-phone" aria-hidden="true"></i>(+52) 5621204896</li>
                <li><i class="fa fa-envelope-o" aria-hidden="true"></i><a href="mailto:er.vikashs4@gmail.com">drstuarthgonz@gmail.com</a></li>
            </ul>
        </div>
        <div class="agileinfo_social_icons">
            <ul class="agileits_social_list">
                <li><a href="https://www.facebook.com/" class="w3_agile_facebook"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
                <li><a href="https://twitter.com/" class="agile_twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
                <li><a href="https://www.linkedin.com/in/vikash-kumar-040006166/" class="w3_agile_linkedin"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
            </ul>
        </div>
        <div class="clearfix"> </div>
    </div>				
    <div class="header-bottom">
        <nav class="navbar navbar-default">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <div class="logo">
                    <h3><a class="navbar-brand" href="index.html"> Dr. Stuarth <p>Gonzalez</p></a></h3>
                </div>
            </div>
            <div class="collapse navbar-collapse nav-wil" id="bs-example-navbar-collapse-1">
                <nav class="menu menu--sebastian">
                    <ul id="m_nav_list" class="m_nav menu__list">
                        <li class="m_nav_item menu__item" id="m_nav_item_1"> <a href="index.html" class="menu__link">Inicio</a></li>
                        <li class="m_nav_item menu__item" id="moble_nav_item_2"> <a href="about.html" class="menu__link">Nosotros</a> </li>
                        <li class="m_nav_item menu__item" id="moble_nav_item_4"> <a href="appointment.html" class="menu__link">Citas</a> </li>
                        <li class="m_nav_item menu__item" id="moble_nav_item_5"> <a href="gallery.html" class="menu__link">Galeria</a> </li>
                        <li class="m_nav_item menu__item" id="moble_nav_item_6"> <a href="contact.html" class="menu__link">Contacto</a> </li>
                        <li class="m_nav_item menu__item" id="moble_nav_item_7"> <a href="manage_schedule.html" class="menu__link">Horario</a> </li>
                        <li class="m_nav_item menu__item" id="moble_nav_item_3 dropdown"> <a href="#" class="menu__link dropdown-toggle" data-toggle="dropdown">Sesion<b class="caret"></b></a> 
                            <ul class="dropdown-menu agile_short_dropdown"></ul>
                        </li>
                    </ul>
                </nav>
            </div>
        </nav>
    </div>
</div>

<div class="banner-bottom" id="about">
    <div class="container">
        <h2 class="w3_heade_tittle_agile">Gestionar Horarios</h2>
        <p class="sub_t_agileits">Administra los horarios disponibles</p>
        <div class="book-appointment">
            <h4>Agrega un nuevo horario</h4>
            <form id="scheduleForm">
                <div class="left-agileits-w3layouts same">
                    <div class="gaps">
                        <p>Fecha</p>
                        <input id="scheduleDate" name="date" type="text" required="">
                    </div>
                    <div class="gaps">
                        <p>Hora</p>
                        <input type="text" id="scheduleTime" name="time" required>
                    </div>
                </div>
                <div class="clearfix"></div>
                <input type="submit" value="Agregar Horario">
            </form>
            <h4>Horarios Disponibles</h4>
            <div id="scheduleList"></div>
        </div>
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_AUTH_DOMAIN",
        databaseURL: "YOUR_DATABASE_URL",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_STORAGE_BUCKET",
        messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
        appId: "YOUR_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    document.getElementById('scheduleForm').addEventListener('submit', function(event) {
        event.preventDefault();
        const formData = new FormData(event.target);
        const scheduleData = {};
        formData.forEach((value, key) => {
            scheduleData[key] = value;
        });
        const newScheduleRef = database.ref('schedules').push();
        newScheduleRef.set(scheduleData)
            .then(() => {
                alert("Horario agregado correctamente!");
                loadSchedules();
            })
            .catch((error) => {
                console.error("Error saving data: ", error);
            });
    });

    function loadSchedules() {
        const scheduleList = document.getElementById('scheduleList');
        scheduleList.innerHTML = '';
        database.ref('schedules').once('value', (snapshot) => {
            snapshot.forEach((childSnapshot) => {
                const schedule = childSnapshot.val();
                const div = document.createElement('div');
                div.innerHTML = `Fecha: ${schedule.date}, Hora: ${schedule.time} <button onclick="deleteSchedule('${childSnapshot.key}')">Eliminar</button>`;
                scheduleList.appendChild(div);
            });
        });
    }

    function deleteSchedule(scheduleId) {
        database.ref('schedules/' + scheduleId).remove()
            .then(() => {
                alert("Horario eliminado correctamente!");
                loadSchedules();
            })
            .catch((error) => {
                console.error("Error deleting data: ", error);
            });
    }

    window.onload = loadSchedules;
</script>
<script src="js/jquery-2.2.3.min.js"></script>
<script src="js/bootstrap.js"></script>
</body>
</html>
